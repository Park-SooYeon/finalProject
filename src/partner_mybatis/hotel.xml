<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>
<mapper namespace="hotel">
	<select id="select" parameterType="String" resultType="bean.PlaceVo">
		SELECT p.photo_name ,h.place_name, h.place_location, h.place_tel, (
			SELECT count(r.rooms_serial) cnt
			FROM ROOMS r JOIN PLACE p
			ON r.PLACE_SERIAL = p.PLACE_SERIAL
		) room_cnt, h.state
		FROM PLACE h LEFT OUTER JOIN PLACE_PHOTO p 
		ON h.place_serial = p.place_serial 
		WHERE place_code=4
		and member_id=#{member_id}
	</select>	
	
	<!-- 파트너 시리얼 조회 -->
	<select id="select_serial" parameterType="String" resultType="Integer">
		SELECT partner_serial
		FROM PARTNER
		WHERE MEMBER_ID=#{member_id};
	</select>
	
	
	<insert id="insert" parameterType="bean.PlaceVo" >
		INSERT INTO place (place_serial, partner_serial, place_code, place_name, place_location, LATITUDE, LONGITUDE, grade, state, BREAKFAST, WI_FI, PARKING, LOCAL_CODE, PLACE_TEL)
		VALUES (seq_place.nextval, #{partner_serial}, 4, #{place_name}, #{place_location}, #{latitude}, #{longitude}, #{grade}, #{breakfast}, #{wifi}, #{parking}, #{local_code}, #{place_tel})
	</insert>
</mapper>